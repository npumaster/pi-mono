import type { AutocompleteProvider } from "./autocomplete.js";
import type { Component } from "./tui.js";

/**
 * 自定义编辑器组件接口。
 *
 * 这允许扩展提供自己的编辑器实现
 * （例如 vim 模式、emacs 模式、自定义按键绑定），同时保持
 * 与核心应用程序的兼容性。
 */
export interface EditorComponent extends Component {
	// =========================================================================
	// 核心文本访问（必选）
	// =========================================================================

	/** 获取当前文本内容 */
	getText(): string;

	/** 设置文本内容 */
	setText(text: string): void;

	/** 处理原始终端输入（按键、粘贴序列等） */
	handleInput(data: string): void;

	// =========================================================================
	// 回调（必选）
	// =========================================================================

	/** 当用户提交时调用（例如 Enter 键） */
	onSubmit?: (text: string) => void;

	/** 当文本更改时调用 */
	onChange?: (text: string) => void;

	// =========================================================================
	// 历史记录支持（可选）
	// =========================================================================

	/** 将文本添加到历史记录中以进行上/下导航 */
	addToHistory?(text: string): void;

	// =========================================================================
	// 高级文本操作（可选）
	// =========================================================================

	/** 在当前光标位置插入文本 */
	insertTextAtCursor?(text: string): void;

	/**
	 * 获取已展开任何标记（例如粘贴标记）的文本。
	 * 如果未实现，则回退到 getText()。
	 */
	getExpandedText?(): string;

	// =========================================================================
	// 自动补全支持（可选）
	// =========================================================================

	/** 设置自动补全提供者 */
	setAutocompleteProvider?(provider: AutocompleteProvider): void;

	// =========================================================================
	// 外观（可选）
	// =========================================================================

	/** 边框颜色函数 */
	borderColor?: (str: string) => string;

	/** 设置水平内边距 */
	setPaddingX?(padding: number): void;

	/** 设置自动补全下拉菜单中的最大可见项数 */
	setAutocompleteMaxVisible?(maxVisible: number): void;
}
